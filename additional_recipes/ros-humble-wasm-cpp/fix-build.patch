diff --git a/rmw_wasm_cpp/CMakeLists.txt b/rmw_wasm_cpp/CMakeLists.txt
index 509f84e..a825df5 100644
--- a/rmw_wasm_cpp/CMakeLists.txt
+++ b/rmw_wasm_cpp/CMakeLists.txt
@@ -30,6 +30,13 @@ find_package(rosidl_runtime_cpp REQUIRED)
 find_package(rosidl_typesupport_introspection_c REQUIRED)
 find_package(rosidl_typesupport_introspection_cpp REQUIRED)
 
+
+find_package(BZip2 REQUIRED)
+find_package(SQLite3 REQUIRED)
+find_package(ZLIB REQUIRED)
+find_package(PkgConfig REQUIRED)
+pkg_check_modules(libffi REQUIRED libffi)
+
 set(${PROJECT_NAME}_SOURCES
   src/rmw_wasm_identifier.cpp
   src/rmw_wasm_guard_condition.cpp
@@ -60,6 +67,7 @@ set(${PROJECT_NAME}_SOURCES
 )
 
 add_library(${PROJECT_NAME} SHARED ${${PROJECT_NAME}_SOURCES})
+target_link_libraries(${PROJECT_NAME} ${libffi_LINK_LIBRARIES} ${SQLite3_LIBRARIES} BZip2::BZip2 ZLIB::ZLIB)
 
 target_include_directories(${PROJECT_NAME} PRIVATE
   "$<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>"
diff --git a/wasm_cpp/cmake/WasmBuildOptions.cmake b/wasm_cpp/cmake/WasmBuildOptions.cmake
index 0b8ed3a..87c4fbe 100644
--- a/wasm_cpp/cmake/WasmBuildOptions.cmake
+++ b/wasm_cpp/cmake/WasmBuildOptions.cmake
@@ -9,7 +9,7 @@ endfunction()
 function(wasm_link_options target)
     target_link_options("${target}"
         PUBLIC "SHELL: -lembind"
-        PUBLIC "SHELL: --pre-js ${CMAKE_SOURCE_DIR}/pre.js"
+        PUBLIC "SHELL: --pre-js ${CMAKE_SOURCE_DIR}/src/pre.js"
         PUBLIC "SHELL: -fexceptions"
         PUBLIC "SHELL: -s ASYNCIFY=1"
         PUBLIC "SHELL: -s ALLOW_MEMORY_GROWTH=1"
diff --git a/wasm_cpp/include/wasm_cpp/context.hpp b/wasm_cpp/include/wasm_cpp/context.hpp
index b06d8ca..01187c8 100644
--- a/wasm_cpp/include/wasm_cpp/context.hpp
+++ b/wasm_cpp/include/wasm_cpp/context.hpp
@@ -48,7 +48,7 @@ namespace wasm_cpp
 
             // TODO: wasm objects
 
-            RosLibJS& get_roslib_js();
+           WASM_CPP_PUBLIC RosLibJS& get_roslib_js();
 
         private:
             void init_context();
